#!/bin/bash

# subdomain_enum.sh - A script to enumerate subdomains using subfinder
# Usage: ./subdomain_enum.sh <domain>

# Exit immediately if a command exits with a non-zero status
set -e

# Function to display usage information
usage() {
    echo "Subdomain Enumeration Script"
    echo "----------------------------"
    echo "Usage: $0 <domain>"
    echo ""
    echo "Example: $0 example.com"
    echo ""
    exit 1
}

# Check if subfinder is installed
check_dependencies() {
    if ! command -v subfinder &> /dev/null; then
        echo "Error: subfinder is not installed or not in PATH"
        echo "Install it with: GO111MODULE=on go get -v github.com/projectdiscovery/subfinder/v2/cmd/subfinder"
        exit 1
    fi
}

# Main function to enumerate subdomains
enumerate_subdomains() {
    local domain=$1
    
    echo "[+] Starting subdomain enumeration for $domain"
    echo "[+] Using subfinder..."
    
    # Run subfinder with default options
    subfinder -d "$domain" -o /dev/stdout
    
    echo "[+] Subdomain enumeration completed"
}

# Main execution
main() {
    # Check for domain argument
    if [ $# -ne 1 ]; then
        usage
    fi
    
    local domain=$1
    
    # Validate domain format (basic check)
    if [[ ! $domain =~ ^[a-zA-Z0-9][a-zA-Z0-9-]+\.[a-zA-Z]{2,}$ ]]; then
        echo "Error: Invalid domain format. Please provide a valid domain (e.g., example.com)"
        exit 1
    fi
    
    # Check dependencies
    check_dependencies
    
    # Run enumeration
    enumerate_subdomains "$domain"
}

# Call main with all arguments
main "$@" 